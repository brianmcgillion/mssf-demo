<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>

<!-- Do not allow just any process to create the service -->
  <policy context="default">
    <deny own="com.meego.mssf"/>
  </policy>

<!-- Allow the process with "t_mssfd" to create and own the service -->
  <policy smack="t_mssfd">
    <allow own="com.meego.mssf"/>
  </policy>

<!-- Open up the interface for everyone -->
<policy context="default">
   <allow send_destination="com.meego.mssf"
	  send_interface="com.meego.mssf"/>
   <allow receive_sender="com.meego.mssf"
	  receive_interface="com.meego.mssf"/>
</policy>

<!-- deny anybody sending to the setState() method -->
<policy context="default">
   <deny send_destination="com.meego.mssf"
         send_interface="com.meego.mssf" send_member="setState"/>
 </policy>

<!-- Allow a process with write access the t_client label send to setState() -->
<policy smack="t_client">
   <allow send_destination="com.meego.mssf"
send_interface="com.meego.mssf" send_member="setState"/>
 </policy>
 
</busconfig>
