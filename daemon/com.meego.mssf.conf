<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- Do not allow just any process to create the service -->
  <policy context="default">
    <deny own="com.meego.mssf"/>
  </policy>

  <!-- Allow the process with "t_mssfd" to create and own the service -->
  <policy smack="t_mssfd">
    <allow own="com.meego.mssf"/>
  </policy>
  
  <!-- open up the interface for everyone, by default service is accesable -->
  <policy context="default">
    <allow send_destination="com.meego.mssf"
	   send_interface="com.meego.mssf"/>
    <allow receive_sender="com.meego.mssf"
	   receive_interface="com.meego.mssf"/>
  </policy>

  <!-- deny anybody calling to the setState() method -->
  <policy context="default">
    <deny send_destination="com.meego.mssf"
	  send_interface="com.meego.mssf" send_member="setState"/>
  </policy>
  
  <!-- Allow a proc with write access to t_client label call to setState() -->
  <policy smack="t_setState">
    <allow send_destination="com.meego.mssf"
	   send_interface="com.meego.mssf" send_member="setState"/>
  </policy>

  <!-- close off the secure signal -->
  <policy context="default">
    <deny receive_sender="com.meego.mssf"
	  receive_interface="com.meego.mssf" receive_member="stateChanged"/>
  </policy>

  <!-- allow acess for those who have access to the t_signal label -->
  <policy smack="t_signal">
    <allow receive_sender="com.meego.mssf"
	   receive_interface="com.meego.mssf" receive_member="stateChanged"/>
  </policy>

</busconfig>
